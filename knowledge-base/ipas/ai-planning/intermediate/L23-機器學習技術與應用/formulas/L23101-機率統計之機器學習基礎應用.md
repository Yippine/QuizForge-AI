# L23101 - 機率統計之機器學習基礎應用

## 1. 核心定義 (20%, 400-1200字)

### 1.1 主題定義

機率統計是機器學習的數學基礎核心，處理資料中不可避免的不確定性與隨機性。真實世界的資料往往受限於觀察條件、取樣變異或內在隨機性，使得預測結果不具唯一性與確定性。機器學習模型的核心任務並非尋找絕對規則，而是建構能處理資料不確定性的機率模型，並在此基礎上進行合理的預測與決策。

機率統計賦予機器學習三項核心能力：描述資料行為（機率分佈）、建模條件關係（條件機率與貝氏定理）、驗證統計顯著性（假設檢定與 p 值）。從資料生成機制的假設到模型評估的統計推論，機率統計貫穿整個機器學習流程。

### 1.2 核心概念

**機率統計在機器學習中的五大核心概念：**

1. **隨機變數與機率分佈**：用數學函數描述資料的不確定性，區分離散型（伯努利、二項、泊松）與連續型（常態、均勻、指數、卡方）
2. **條件機率**：在給定條件下估算事件發生機率，形式為 P(Y|X)，是分類與預測的邏輯核心
3. **貝氏定理**：整合先驗知識與新資料觀察，即時更新後驗機率，支撐貝氏推論與模型更新
4. **統計推論與假設檢定**：利用樣本資料推論母體參數，透過 p 值判斷統計顯著性
5. **統計量**：期望值、變異數、標準差、偏態、峰度等描述資料分佈特性的指標

### 1.3 CFDS 分解

基於 Formula-Contract 方法論，將機率統計在機器學習中的應用分解為四個基本單元：

```
ProbabilityStatistics_ML = f(C, F, D, S)
```

**C (Code - 可執行邏輯)**
```
C = DistributionModeling ∘ ConditionalInference ∘ BayesianUpdate ∘ HypothesisTesting
  = 分佈建模 -> 條件推論 -> 貝氏更新 -> 假設檢定
```

**F (Files - 配置資源)**
```
F = {DistributionParameters, PriorProbabilities, StatisticalTables, TestingConfigs}
  = {分佈參數, 先驗機率, 統計表, 檢定配置}
```

**D (Data - 資料結構)**
```
D = RandomVariables + Samples + ProbabilityDistributions + TestStatistics
  = 隨機變數 + 樣本資料 + 機率分佈 + 檢定統計量
```

**S (State - 運行狀態)**
```
S = DistributionFitting | BayesianInference | HypothesisTesting
  = 分佈擬合狀態 | 貝氏推論狀態 | 假設檢定狀態
```

### 1.4 技術定位

機率統計在機器學習技術棧中處於基礎數學層，與線性代數、數值優化並列為三大數學支柱。機率統計專注於處理資料的不確定性與隨機性，提供模型假設的數學基礎（如邏輯迴歸假設伯努利分佈、線性迴歸假設誤差常態分佈）、支撐統計推論與模型評估（假設檢定、信賴區間）、驅動貝氏機器學習方法（貝氏網路、變分推斷）。

在企業應用中，機率統計能量化預測的不確定性、評估模型的統計顯著性、支撐風險控制與決策制定，是數據驅動決策的理論保障。

---

## 2. 關鍵公式 (25%, 500-1500字)

### 2.1 機率分佈主公式

機器學習中的核心邏輯是學習條件機率分佈：

```
MachineLearningModel = P(Y|X)
```

其中 X 為輸入特徵（Feature）、Y 為目標變數（Label）。

### 2.2 離散型機率分佈公式

**機率質量函數（PMF）**：
```
P(X = x_i) = 某特定取值的機率
∑P(X = x_i) = 1 (所有機率總和為1)
```

**伯努利分佈（Bernoulli Distribution）**：
```
P(X = k) = p^k × (1-p)^(1-k), k ∈ {0, 1}
```
- **應用**：二元分類（成功/失敗、點擊/未點擊）
- **參數**：p = 成功機率

**二項分佈（Binomial Distribution）**：
```
P(X = k) = C(n, k) × p^k × (1-p)^(n-k)
其中 C(n, k) = n! / (k!(n-k)!)
```
- **應用**：n 次獨立試驗中成功 k 次的機率
- **參數**：n = 試驗次數, p = 單次成功機率

**泊松分佈（Poisson Distribution）**：
```
P(X = k) = (λ^k × e^(-λ)) / k!
```
- **應用**：固定時間/空間區間內稀有事件發生次數（客服來電數、網站請求數）
- **參數**：λ = 平均發生率

### 2.3 連續型機率分佈公式

**機率密度函數（PDF）**：
```
P(a ≤ X ≤ b) = ∫[a到b] f(x) dx
```

**常態分佈（Normal Distribution）**：
```
f(x) = (1 / (σ√(2π))) × exp(-(x-μ)² / (2σ²))
記作 X ~ N(μ, σ²)
```
- **應用**：誤差建模、參數估計、特徵標準化、生成模型
- **參數**：μ = 期望值（平均數）、σ² = 變異數

**均勻分佈（Uniform Distribution）**：
```
f(x) = 1 / (b-a), x ∈ [a, b]
```
- **應用**：參數初始化、隨機抽樣

**指數分佈（Exponential Distribution）**：
```
f(x) = λ × e^(-λx), x ≥ 0
```
- **應用**：等待時間、生存時間建模（機器故障時間、電話來電間隔）
- **特性**：無記憶性（Memoryless）

**卡方分佈（Chi-square Distribution）**：
```
χ² = ∑(i=1 到 k) Z_i²
其中 Z_i ~ N(0, 1) 為標準常態分佈
```
- **應用**：變異數分析、卡方適合度檢定、列聯表獨立性檢定

### 2.4 條件機率與貝氏定理公式

**條件機率**：
```
P(A|B) = P(A ∩ B) / P(B)
```

**貝氏定理（Bayes' Theorem）**：
```
P(A|B) = P(B|A) × P(A) / P(B)
```

**四要素拆解**：
```
後驗機率 = (似然 × 先驗機率) / 邊際機率

P(A|B) = 後驗機率 (Posterior) - 觀察 B 後更新的 A 機率
P(B|A) = 似然 (Likelihood) - A 發生時 B 的條件機率
P(A) = 先驗機率 (Prior) - 初始對 A 的信念
P(B) = 邊際機率 (Marginal) - B 的總體機率
```

**貝氏定理在機器學習中的應用公式**：
```
樸素貝氏分類器：
P(Y|X) = P(X|Y) × P(Y) / P(X)
     = P(x_1, x_2, ..., x_n | Y) × P(Y) / P(X)
     ≈ ∏(i=1 到 n) P(x_i|Y) × P(Y) / P(X) (假設特徵獨立)
```

### 2.5 假設檢定與 p 值公式

**假設檢定流程**：
```
HypothesisTesting = SetHypothesis -> CalculateTestStatistic -> ComputePValue -> Decision
                  = 設定假設 -> 計算檢定統計量 -> 計算p值 -> 決策
```

**虛無假設與對立假設**：
```
H₀: 虛無假設 (Null Hypothesis) - 假設無差異或無效果
H₁: 對立假設 (Alternative Hypothesis) - 假設有差異或有效果
```

**決策準則**：
```
if p-value < α (顯著水準):
    拒絕 H₀ (資料提供足夠證據反駁虛無假設)
else:
    無法拒絕 H₀ (資料不足以反駁虛無假設)
```

**常用顯著水準**：α = 0.05 (5%), 0.01 (1%), 0.001 (0.1%)

### 2.6 統計量公式

**期望值（Expected Value）**：
```
E[X] = ∑(i) x_i × P(X = x_i) (離散型)
E[X] = ∫ x × f(x) dx (連續型)
```

**變異數（Variance）**：
```
Var(X) = E[(X - E[X])²] = E[X²] - (E[X])²
```

**標準差（Standard Deviation）**：
```
σ = √Var(X)
```

**共變異數（Covariance）**：
```
Cov(X, Y) = E[(X - E[X])(Y - E[Y])]
```

**相關係數（Correlation Coefficient）**：
```
ρ(X, Y) = Cov(X, Y) / (σ_X × σ_Y)
```

---

## 3. 對比矩陣 (15%, 300-900字)

### 3.1 離散型 vs 連續型機率分佈對比表

| 特性 | 離散型分佈 | 連續型分佈 |
|-----|-----------|-----------|
| **隨機變數** | 有限或可數（整數） | 無限連續（實數） |
| **描述函數** | PMF (機率質量函數) | PDF (機率密度函數) |
| **機率計算** | P(X = x) = 直接求值 | P(a ≤ X ≤ b) = 積分 |
| **機率總和** | ∑P(X = x_i) = 1 | ∫f(x)dx = 1 |
| **代表分佈** | 伯努利、二項、泊松 | 常態、均勻、指數、卡方 |
| **應用場景** | 二元分類、計數問題 | 迴歸預測、誤差建模 |

### 3.2 貝氏方法 vs 頻率方法對比

| 特性 | 貝氏方法 | 頻率方法 |
|-----|---------|---------|
| **機率解釋** | 主觀信念的量化 | 長期頻率的極限 |
| **參數假設** | 參數是隨機變數 | 參數是固定未知值 |
| **先驗知識** | 納入先驗機率 | 不考慮先驗知識 |
| **更新機制** | 貝氏定理更新後驗 | 無更新機制 |
| **優點** | 整合先驗知識、可即時更新、提供機率分佈 | 客觀、易於理解、計算簡單 |
| **缺點** | 先驗選擇主觀、計算複雜 | 無法整合先驗、單次推論 |
| **應用場景** | 貝氏網路、變分推斷、線上學習 | 假設檢定、信賴區間、經典統計 |

### 3.3 常見機率分佈應用場景對比

| 分佈 | 類型 | 典型應用 | 機器學習案例 |
|-----|-----|---------|-------------|
| **伯努利** | 離散 | 二元事件 | 邏輯迴歸、二元分類 |
| **二項** | 離散 | 多次獨立試驗 | A/B 測試、轉換率分析 |
| **泊松** | 離散 | 稀有事件計數 | 異常檢測、流量預測 |
| **常態** | 連續 | 誤差建模 | 線性迴歸、特徵標準化、生成模型 |
| **均勻** | 連續 | 隨機抽樣 | 參數初始化、dropout |
| **指數** | 連續 | 等待時間 | 生存分析、時間序列 |
| **卡方** | 連續 | 統計檢定 | 特徵選擇、獨立性檢定 |

---

## 4. 實務應用 (20%, 400-1200字)

### 4.1 應用場景一：垃圾郵件分類（樸素貝氏分類器）

**場景描述**：根據郵件內容判斷是否為垃圾郵件

**技術應用**：
```
P(垃圾|郵件內容) = P(郵件內容|垃圾) × P(垃圾) / P(郵件內容)
                = ∏P(詞_i|垃圾) × P(垃圾) / P(郵件內容)
```

**實現要點**：
1. 計算先驗機率 P(垃圾) 和 P(正常)
2. 對每個詞計算條件機率 P(詞|垃圾) 和 P(詞|正常)
3. 假設詞彙獨立（樸素假設），連乘所有詞的條件機率
4. 比較 P(垃圾|郵件) vs P(正常|郵件)，選擇較大者

**優勢**：計算簡單、訓練快速、可解釋性高

### 4.2 應用場景二：A/B 測試（二項分佈與假設檢定）

**場景描述**：比較兩個網頁設計版本的點擊率是否有顯著差異

**技術應用**：
```
H₀: p_A = p_B (兩版本點擊率無差異)
H₁: p_A ≠ p_B (兩版本點擊率有差異)

檢定統計量 z = (p̂_A - p̂_B) / √(p̂(1-p̂)(1/n_A + 1/n_B))
其中 p̂ = (x_A + x_B) / (n_A + n_B)
```

**實現要點**：
1. 設定顯著水準 α = 0.05
2. 收集樣本：版本A (n_A次展示, x_A次點擊)、版本B (n_B次展示, x_B次點擊)
3. 計算 z 統計量和 p 值
4. 若 p < α，拒絕 H₀，認為兩版本有顯著差異

**常見陷阱**：樣本量不足、多重檢定問題、未考慮季節性

### 4.3 應用場景三：醫療診斷（貝氏定理應用）

**場景描述**：根據檢測結果更新疾病機率

**技術應用**：
```
P(患病|陽性) = P(陽性|患病) × P(患病) / P(陽性)

其中：
P(患病) = 疾病盛行率（先驗機率）
P(陽性|患病) = 敏感度（Sensitivity）
P(陽性|健康) = 1 - 特異度（Specificity）
P(陽性) = P(陽性|患病)×P(患病) + P(陽性|健康)×P(健康)
```

**實現要點**：
1. 確定疾病盛行率（先驗機率）
2. 了解檢測的敏感度和特異度
3. 使用貝氏定理計算後驗機率
4. 根據後驗機率進行醫療決策

**案例數值**：假設疾病盛行率 1%，檢測敏感度 95%，特異度 95%，即使檢測陽性，實際患病機率也只有約 16%（而非 95%），因為先驗機率太低。

### 4.4 實作步驟：機率統計在機器學習中的通用流程

```
步驟1：選擇機率分佈
       根據資料特性選擇合適的分佈（離散/連續、範圍、對稱性）

步驟2：參數估計
       使用最大概似估計（MLE）或貝氏估計獲得分佈參數

步驟3：條件機率建模
       建立 P(Y|X) 的條件機率模型

步驟4：模型訓練
       透過訓練資料學習條件機率分佈的參數

步驟5：統計推論
       使用假設檢定評估特徵顯著性、模型差異

步驟6：預測與決策
       基於機率分佈進行預測，提供不確定性量化

步驟7：模型評估
       使用統計量（如對數概似、KL 散度）評估模型品質
```

### 4.5 常見陷阱

1. **分佈假設錯誤**：假設常態分佈但資料實際為偏態分佈，導致模型失準
2. **樣本量不足**：統計推論需要足夠樣本，小樣本易產生誤導性結論
3. **p 值誤解**：p < 0.05 不代表「效果很大」或「95%正確」，只表示「在 H₀ 為真時，觀察到如此極端資料的機率 < 5%」
4. **多重檢定問題**：進行多次假設檢定時，偶然出現顯著結果的機率增加，需進行 Bonferroni 修正等調整
5. **忽略先驗機率**：在貝氏推論中，先驗機率的選擇顯著影響後驗結果，不可忽視

---

## 5. 記憶口訣 (10%, 200-600字)

### 5.1 核心口訣

**機率統計四部曲：分佈、條件、貝氏、檢定**
```
分佈建模描述資料，條件機率學習預測
貝氏定理更新信念，假設檢定驗證顯著
```

**貝氏定理四要素：先驗、似然、邊際、後驗**
```
先驗是初始信念，似然是條件證據
邊際是總體機率，後驗是更新結論
口訣：先似邊後（先驗→似然→邊際→後驗）
```

**離散連續二分法：PMF 算點，PDF 算區間**
```
離散變數 PMF，直接算點機率
連續變數 PDF，積分算區間
總和皆為一，歸一化條件
```

### 5.2 記憶技巧

**分佈選擇記憶法**：
- **伯努利**：「兩」種結果（成功/失敗）→ 「兩」項分佈
- **二項**：「多次」伯努利 → 「二」項累積
- **泊松**：「稀有」事件 → 「泊」來品（稀少）
- **常態**：「常」見且「對稱」→ 鐘型分佈
- **指數**：「等待」時間 → 「指」望等多久

**貝氏定理記憶圖像**：
```
想像偵探辦案：
先驗 = 案發前的嫌疑人名單
似然 = 新證據與嫌疑人的關聯度
邊際 = 證據出現的總機率
後驗 = 結合證據後更新的嫌疑度
```

**假設檢定記憶口訣**：
```
「P小拒H零，P大留H零」
p 值小於 α，拒絕虛無假設
p 值大於 α，無法拒絕虛無假設
```

### 5.3 快速回憶

**考試快速檢索表**：
```
機率分佈 = {
  離散: [伯努利(p), 二項(n,p), 泊松(λ)]
  連續: [常態(μ,σ²), 均勻(a,b), 指數(λ), 卡方(k)]
}

貝氏定理 = P(A|B) = P(B|A) × P(A) / P(B)

假設檢定 = {
  1. 設定 H₀ 和 H₁
  2. 選擇檢定方法
  3. 決定 α (通常0.05)
  4. 計算 p 值
  5. 比較決策：p < α → 拒絕 H₀
}
```

### 5.4 易混淆辨析

| 易混淆概念 | 區別要點 |
|----------|---------|
| **期望值 vs 眾數** | 期望值是加權平均，眾數是出現最多的值 |
| **變異數 vs 標準差** | 變異數是平方，標準差是開根號，單位不同 |
| **先驗 vs 後驗** | 先驗在觀察前，後驗在觀察後 |
| **似然 vs 機率** | 似然固定資料看參數，機率固定參數看資料 |
| **p值 vs 顯著水準α** | p值是計算結果，α是預設閾值 |
| **型一錯誤 vs 型二錯誤** | 型一是誤拒H₀（假陽性），型二是誤不拒H₀（假陰性） |

---

## 6. 自我驗證 (10%, 200-600字)

### 6.1 選擇題

**題目1**：在機器學習中，邏輯迴歸假設目標變數服從哪種機率分佈？
- A. 常態分佈
- B. 伯努利分佈
- C. 泊松分佈
- D. 均勻分佈

**題目2**：貝氏定理中的「先驗機率」指的是什麼？
- A. 觀察資料後更新的機率
- B. 觀察資料前的初始機率
- C. 條件發生的似然機率
- D. 資料的邊際機率

**題目3**：假設檢定中，若 p 值 = 0.03，顯著水準 α = 0.05，應該如何決策？
- A. 接受虛無假設
- B. 拒絕虛無假設
- C. 無法決策
- D. 需要更多資料

**題目4**：下列哪個分佈用於描述固定時間內稀有事件發生的次數？
- A. 二項分佈
- B. 泊松分佈
- C. 指數分佈
- D. 卡方分佈

**題目5**：連續型隨機變數的機率密度函數（PDF）必須滿足什麼條件？
- A. 所有取值的機率總和為 1
- B. 在整個定義域上的積分為 1
- C. 最大值為 1
- D. 期望值為 0

### 6.2 簡答題

**題目1**：說明貝氏定理如何在醫療診斷中應用，並解釋為什麼即使檢測陽性，實際患病機率可能仍然很低。

**題目2**：解釋機器學習模型為什麼需要建立條件機率 P(Y|X) 而非簡單的分類規則。

### 6.3 答案解析

**選擇題答案**：
1. **B. 伯努利分佈** - 邏輯迴歸用於二元分類，輸出 0 或 1，符合伯努利分佈的定義（參考第2.2節）
2. **B. 觀察資料前的初始機率** - 先驗機率是在觀察證據 B 之前，對事件 A 的初始信念（參考第2.4節）
3. **B. 拒絕虛無假設** - 因為 p (0.03) < α (0.05)，資料提供足夠證據拒絕 H₀（參考第2.5節）
4. **B. 泊松分佈** - 泊松分佈專門描述固定時間/空間區間內稀有事件的發生次數（參考第2.2節）
5. **B. 在整個定義域上的積分為 1** - PDF 透過積分計算機率，∫f(x)dx = 1 是歸一化條件（參考第2.3節）

**簡答題答案**：

**題目1 答案**：
貝氏定理在醫療診斷中的公式為：
```
P(患病|陽性) = P(陽性|患病) × P(患病) / P(陽性)
```

即使檢測陽性，實際患病機率可能很低的原因是**先驗機率（疾病盛行率）太低**。

案例說明：假設疾病盛行率僅 1%（先驗），檢測敏感度 95%，特異度 95%：
```
P(患病|陽性) = 0.95 × 0.01 / [0.95×0.01 + 0.05×0.99]
             ≈ 0.16 (16%)
```
雖然檢測陽性，但由於疾病本身罕見，實際患病機率僅 16%，而非 95%。這凸顯先驗機率在貝氏推論中的重要性（參考第4.3節）。

**題目2 答案**：
機器學習模型建立條件機率 P(Y|X) 而非簡單分類規則的原因有三：

1. **不確定性量化**：條件機率提供預測的信心程度，而非僅給出「是/否」答案。例如 P(垃圾郵件|內容) = 0.95 告訴我們「非常可能是垃圾郵件」，而非單純的「是垃圾郵件」。

2. **風險控制**：在醫療診斷、金融風控等高風險應用中，需要知道預測的可靠度以進行決策。低機率預測可能需要人工複核。

3. **模型彈性**：條件機率允許根據不同的成本效益調整決策閾值。例如在欺詐檢測中，可以設定 P(欺詐|交易) > 0.3 就標記為可疑，而非固定的 0.5。

這種機率建模是處理真實世界不確定性的核心方法（參考第1.1節、第2.1節）。

### 6.4 易錯點提醒

1. **p 值不是「假設為真的機率」**：p 值是「在 H₀ 為真時，觀察到如此極端資料的機率」，不能反過來說「H₀ 為真的機率是 p」
2. **連續型隨機變數的單點機率為 0**：P(X = a) = 0，只能計算區間機率 P(a ≤ X ≤ b)
3. **貝氏定理的分母常被忽略**：P(B) = P(B|A)×P(A) + P(B|¬A)×P(¬A)，需要考慮所有可能情況
4. **混淆先驗與後驗**：先驗在觀察前、後驗在觀察後，順序不可顛倒
5. **假設檢定的決策是「拒絕」或「無法拒絕」H₀**：永遠不說「接受 H₀」，因為無法證明假設為真，只能說資料不足以反駁
